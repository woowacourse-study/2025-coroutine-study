# Chapter 10. 코루틴의 이해

# 10.1 서브루틴과 코루틴

## 10.1.1 루틴과 서브루틴

- 루틴 : 특정한 일을 처리하기 위한 일련의 명령 → 함수 또는 메서드
- 서브루틴 : 함수 내에서 함수가 호출될 경우 호출된 함수를 서브루틴이라고 함
    - 함수의 하위에서 실행되는 함수
    - 루틴에 의해 서브루틴이 호출되면 루틴을 실행하던 스레드는 서브루틴을 실행하는데 사용돼 서브루틴의 실행이 완료될 때까지 다른 작업을 할 수 없음

## 10.1.2 서브루틴과 코루틴의 차이

- 루틴에서 서브루틴이 호출되면 서브루틴이 완료될 때까지 루틴이 아무런 작업을 할 수 없는것과 다르게, 코루틴은 함께 실행되는 루틴으로 서로 간에 스레드 사용을 양보하며 함께 실행 됨
- 코루틴이 협력적으로 동작하기 위해서는 코루틴이 작업을 하지 않는 시점에 스레드 사용 권한을 양보하고 일시 중단해야 함

# 10.2 코루틴 스레드 양보

- 코루틴을 양보하는 주체는 코루틴
- 스레드에 코루틴을 할당해 실행되도록 만드는 주체는 CoroutineDispatcher 객체이지만 스레드를 양보하는 주체는 코루틴으로 CoroutineDispatcher는 코루틴이 스레드를 양보하도록 강제하지 못함
- 코루틴에서 스레드를 양보하려면 코루틴에서 직접 스레드 양보를 위한 함수를 호출해야 함

## 10.2.1 delay 일시 중단 함수를 통해 알아보는 스레드 양보

- 코루틴이 delay 함수를 호출하면 코루틴은 사용하던 스레드를 양보하고 설정된 시간 동안 코루틴을 일시 중단 시킴

## 10.2.2 join과 await의 동작 방식 자세히 알아보기

- Job의 join 함수나 Deffered의 await 함수가 호출되면 해당 함수를 호출한 코루틴은 스레드를 양보하고 join 또는 await의 대상이 된 코루틴 내부의 코드가 실행 완료될 때까지 일시 중단됨
- join이나 await가 호출되면 호출부의 코루틴은 스레드를 양보하고 일시 중단하며, join이나 await의 대상이 된 코루틴이 실행 완료될 때까지 재개되지 않음
    - 그 사이 양보된 스레드는 다른 코루틴을 실행하는데 사용될 수 있음

## 10.2.3 yield 함수 호출해 스레드 양보하기

- yield 함수를 통해 직접 스레드 양보를 실행
- 코루틴이 사용하던 스레드를 명시적으로 양보해야할 때 yield 함수 사용

## 10.3 코루틴의 실행 스레드

- 코루틴의 실행 스레드는 고정이 아님
- 스레드를 양보하지 않으면 실행 스레드가 바뀌지 않음
    - 코루틴의 실행 스레드가 바뀌는 시점은 코루틴이 재개될 때
    - 코루틴이 스레드 양보를 하지 않아 일시 중단될 일이 없다면 실행 스레드가 바뀌지 않음
